<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Introduction to deep learning: Transfer learning</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/lab/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/lab/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/lab/favicon-16x16.png"><link rel="manifest" href="favicons/lab/site.webmanifest"><link rel="mask-icon" href="favicons/lab/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav lab"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="lab-logo" alt="Carpentries Lab" src="assets/images/lab-logo.svg"><abbr class="badge peer-reviewed" title="This lesson has passed peer review.">
          <a href="https://doi.org/10.5281/zenodo.8308391" class="external-link alert-link">
            <i aria-hidden="true" class="icon" data-feather="user-check" style="border-radius: 5px"></i>
            DOI: 10.5281/zenodo.8308391
          </a>
        </abbr>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/5-transfer-learning.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav lab" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Lab" src="assets/images/lab-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Introduction to deep learning
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Introduction to deep learning
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to deep learning
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 85%" class="percentage">
    85%
  </div>
  <div class="progress lab">
    <div class="progress-bar lab" role="progressbar" style="width: 85%" aria-valuenow="85" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/5-transfer-learning.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="1-introduction.html">1. Introduction</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="2-keras.html">2. Classification by a neural network using Keras</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="3-monitor-the-model.html">3. Monitor the training process</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="4-advanced-layer-types.html">4. Advanced layer types</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. Transfer learning
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#what-is-transfer-learning">What is transfer learning?</a></li>
<li><a href="#formulate-outline-the-problem">1. Formulate / Outline the problem</a></li>
<li><a href="#identify-inputs-and-outputs">2. Identify inputs and outputs</a></li>
<li><a href="#prepare-the-data">3. Prepare the data</a></li>
<li><a href="#choose-a-pre-trained-model-or-start-building-architecture-from-scratch">4. Choose a pre-trained model or start building architecture from
scratch</a></li>
<li><a href="#concluding-the-power-of-transfer-learning">Concluding: The power of transfer learning</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="6-outlook.html">6. Outlook</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="4-advanced-layer-types.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="6-outlook.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="4-advanced-layer-types.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Advanced layer types
        </a>
        <a class="chapter-link float-end" href="6-outlook.html" rel="next">
          Next: Outlook...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Transfer learning</h1>
        <p>Last updated on 2025-02-11 |

        <a href="https://github.com/carpentries-lab/deep-learning-intro/edit/main/episodes/5-transfer-learning.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do I apply a pre-trained model to my data?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Adapt a state-of-the-art pre-trained network to your own
dataset</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-transfer-learning">What is transfer learning?<a class="anchor" aria-label="anchor" href="#what-is-transfer-learning"></a></h2>
<hr class="half-width"><p>Instead of training a model from scratch, with transfer learning you
make use of models that are trained on another machine learning task.
The pre-trained network captures generic knowledge during pre-training
and will only be ‘fine-tuned’ to the specifics of your dataset.</p>
<p>An example: Let’s say that you want to train a model to classify
images of different dog breeds. You could make use of a pre-trained
network that learned how to classify images of dogs and cats. The
pre-trained network will not know anything about different dog breeds,
but it will have captured some general knowledge of, on a high-level,
what dogs look like, and on a low-level all the different features
(eyes, ears, paws, fur) that make up an image of a dog. Further training
this model on your dog breed dataset is a much easier task than training
from scratch, because the model can use the general knowledge captured
in the pre-trained network.</p>
<figure><img src="fig/05-transfer_learning.png" class="figure mx-auto d-block"><!--
Edit this plot using the Mermaid live editor:
1. Open this link that includes the source code of the chart to open the live editor web interface:
https://mermaid.live/edit#pako:eNpVkE1vgzAMhv9K5MPUSrQKAWUlh0kr9NZetp02drAgUCRIqhC0dZT_vizso_PJb_zYr-MRCl1KEFC1-q04orFk_5Ar4uL-ZZHpuic3JEXbkwwtLl_JanVHLk8GG0UOrrO9kO3CJ-QKXs4T0tGBqq-kIXuJRjWqnubK1s9JZ5F5I7I1Upb_fL7rqRe7a8g7LiGATpoOm9J9YPyCc7BH2ckchEtLWeHQ2hxyNTkUB6sfz6oAYc0gAzB6qI8gKmx7p4ZTiVZmDdYGu9_XE6pnrf-0LBurzWE-mb-cZ0CM8A5iRdfUBeObmEZJzKOEJRHnUQBnECwK15zRMGJxzNkmoXwK4MMPD30bpSHjt5SHSfyzzs7bzQtPn9Xpf_E
2. Make changes to the chart as desired in the live editor
3. Download the newly created diagram from the live editor (Actions / PNG) and replace the existing image in the episode folder (episodes/fig/05-transfer_learning.png)
4. (optional) crop the image to remove the white space around the plot in a separate image editor
5. Update the URL in step 1 of this comment to the new URL of the live editor
--></figure><p>In this episode we will learn how use Keras to adapt a
state-of-the-art pre-trained model to the <a href="https://zenodo.org/records/10970014" class="external-link">Dollar Street
Dataset</a>.</p>
</section><section><h2 class="section-heading" id="formulate-outline-the-problem">1. Formulate / Outline the problem<a class="anchor" aria-label="anchor" href="#formulate-outline-the-problem"></a></h2>
<hr class="half-width"><p>Just like in the previous episode, we use the Dollar Street 10
dataset.</p>
<p>We load the data in the same way as the previous episode:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pathlib</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>DATA_FOLDER <span class="op">=</span> pathlib.Path(<span class="st">'data/dataset_dollarstreet/'</span>) <span class="co"># change to location where you stored the data</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>train_images <span class="op">=</span> np.load(DATA_FOLDER <span class="op">/</span> <span class="st">'train_images.npy'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>val_images <span class="op">=</span> np.load(DATA_FOLDER <span class="op">/</span> <span class="st">'test_images.npy'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>train_labels <span class="op">=</span> np.load(DATA_FOLDER <span class="op">/</span> <span class="st">'train_labels.npy'</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>val_labels <span class="op">=</span> np.load(DATA_FOLDER <span class="op">/</span> <span class="st">'test_labels.npy'</span>)</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="identify-inputs-and-outputs">2. Identify inputs and outputs<a class="anchor" aria-label="anchor" href="#identify-inputs-and-outputs"></a></h2>
<hr class="half-width"><p>As discussed in the previous episode, the input are images of
dimension 64 x 64 pixels with 3 colour channels each. The goal is to
predict one out of 10 classes to which the image belongs.</p>
</section><section><h2 class="section-heading" id="prepare-the-data">3. Prepare the data<a class="anchor" aria-label="anchor" href="#prepare-the-data"></a></h2>
<hr class="half-width"><p>We prepare the data as before, scaling the values between 0 and
1.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>train_images <span class="op">=</span> train_images <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>val_images <span class="op">=</span> val_images <span class="op">/</span> <span class="fl">255.0</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="choose-a-pre-trained-model-or-start-building-architecture-from-scratch">4. Choose a pre-trained model or start building architecture from
scratch<a class="anchor" aria-label="anchor" href="#choose-a-pre-trained-model-or-start-building-architecture-from-scratch"></a></h2>
<hr class="half-width"><p>Let’s define our model input layer using the shape of our training
images:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># input tensor</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>inputs <span class="op">=</span> keras.Input(train_images.shape[<span class="dv">1</span>:])</span></code></pre>
</div>
<p>Our images are 64 x 64 pixels, whereas the pre-trained model that we
will use was trained on images of 160 x 160 pixels. To adapt our data
accordingly, we add an upscale layer that resizes the images to 160 x
160 pixels during training and prediction.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># upscale layer</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>method <span class="op">=</span> tf.image.ResizeMethod.BILINEAR</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>upscale <span class="op">=</span> keras.layers.Lambda(</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="kw">lambda</span> x: tf.image.resize_with_pad(x, <span class="dv">160</span>, <span class="dv">160</span>, method<span class="op">=</span>method))(inputs)</span></code></pre>
</div>
<p>From the <code>keras.applications</code> module we use the
<code>DenseNet121</code> architecture. This architecture was proposed by
the paper: <a href="https://arxiv.org/abs/1608.06993" class="external-link">Densely Connected
Convolutional Networks (CVPR 2017)</a>. It is trained on the <a href="https://www.image-net.org/" class="external-link">Imagenet</a> dataset, which contains
14,197,122 annotated images according to the WordNet hierarchy with over
20,000 classes.</p>
<p>We will have a look at the architecture later, for now it is enough
to know that it is a convolutional neural network with 121 layers that
was designed to work well on image classification tasks.</p>
<p>Let’s configure the DenseNet121:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>base_model <span class="op">=</span> keras.applications.DenseNet121(include_top<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                                            pooling<span class="op">=</span><span class="st">'max'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                                            weights<span class="op">=</span><span class="st">'imagenet'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                                            input_tensor<span class="op">=</span>upscale,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                                            input_shape<span class="op">=</span>(<span class="dv">160</span>,<span class="dv">160</span>,<span class="dv">3</span>),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                                            )</span></code></pre>
</div>
<div id="ssl-certificate-verify-failed-error" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="ssl-certificate-verify-failed-error" class="callout-inner">
<h3 class="callout-title">SSL: certificate verify failed error</h3>
<div class="callout-content">
<p>If you get the following error message:
<code>certificate verify failed: unable to get local issuer certificate</code>,
you can download <a href="https://storage.googleapis.com/tensorflow/keras-applications/densenet/densenet121_weights_tf_dim_ordering_tf_kernels_notop.h5" class="external-link">the
weights of the model manually</a> and then load in the weights from the
downloaded file:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>base_model <span class="op">=</span> keras.applications.DenseNet121(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    include_top<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    pooling<span class="op">=</span><span class="st">'max'</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    weights<span class="op">=</span><span class="st">'densenet121_weights_tf_dim_ordering_tf_kernels_notop.h5'</span>, <span class="co"># this should refer to the weights file you downloaded</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    input_tensor<span class="op">=</span>upscale,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    input_shape<span class="op">=</span>(<span class="dv">160</span>,<span class="dv">160</span>,<span class="dv">3</span>),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>)</span></code></pre>
</div>
</div>
</div>
</div>
<p>By setting <code>include_top</code> to <code>False</code> we exclude
the fully connected layer at the top of the network, hence the final
output layer. This layer was used to predict the Imagenet classes, but
will be of no use for our Dollar Street dataset. Note that the ‘top
layer’ appears at the bottom in the output of
<code>model.summary()</code>.</p>
<p>We add <code>pooling='max'</code> so that max pooling is applied to
the output of the DenseNet121 network.</p>
<p>By setting <code>weights='imagenet'</code> we use the weights that
resulted from training this network on the Imagenet data.</p>
<p>We connect the network to the <code>upscale</code> layer that we
defined before.</p>
<div class="section level3">
<h3 id="only-train-a-head-network">Only train a ‘head’ network<a class="anchor" aria-label="anchor" href="#only-train-a-head-network"></a></h3>
<p>Instead of fine-tuning all the weights of the DenseNet121 network
using our dataset, we choose to freeze all these weights and only train
a so-called ‘head network’ that sits on top of the pre-trained network.
You can see the DenseNet121 network as extracting a meaningful feature
representation from our image. The head network will then be trained to
decide on which of the 10 Dollar Street dataset classes the image
belongs.</p>
<p>We will turn of the <code>trainable</code> property of the base
model:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>base_model.trainable <span class="op">=</span> <span class="va">False</span></span></code></pre>
</div>
<p>Let’s define our ‘head’ network:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>out <span class="op">=</span> base_model.output</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>out <span class="op">=</span> keras.layers.Flatten()(out)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>out <span class="op">=</span> keras.layers.BatchNormalization()(out)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>out <span class="op">=</span> keras.layers.Dense(<span class="dv">50</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(out)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>out <span class="op">=</span> keras.layers.Dropout(<span class="fl">0.5</span>)(out)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>out <span class="op">=</span> keras.layers.Dense(<span class="dv">10</span>)(out)</span></code></pre>
</div>
<p>Finally we define our model:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>model <span class="op">=</span> keras.models.Model(inputs<span class="op">=</span>inputs, outputs<span class="op">=</span>out)</span></code></pre>
</div>
<div id="inspect-the-densenet121-network" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="inspect-the-densenet121-network" class="callout-inner">
<h3 class="callout-title">Inspect the DenseNet121 network</h3>
<div class="callout-content">
<p>Have a look at the network architecture with
<code>model.summary()</code>. It is indeed a deep network, so expect a
long summary!</p>
<div class="section level3">
<h3 id="trainable-parameters">1.Trainable parameters<a class="anchor" aria-label="anchor" href="#trainable-parameters"></a></h3>
<p>How many parameters are there? How many of them are trainable?</p>
<p>Why is this and how does it effect the time it takes to train the
model?</p>
</div>
<div class="section level3">
<h3 id="head-and-base">2. Head and base<a class="anchor" aria-label="anchor" href="#head-and-base"></a></h3>
<p>Can you see in the model summary which part is the base network and
which part is the head network?</p>
</div>
<div class="section level3">
<h3 id="max-pooling">3. Max pooling<a class="anchor" aria-label="anchor" href="#max-pooling"></a></h3>
<p>Which layer is added because we provided <code>pooling='max'</code>
as argument for <code>DenseNet121()</code>?</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Solutions </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="section level3">
<h3 id="trainable-parameters-1">1. Trainable parameters<a class="anchor" aria-label="anchor" href="#trainable-parameters-1"></a></h3>
<p>Total number of parameters: 7093360, out of which only 53808 are
trainable.</p>
<p>The 53808 trainable parameters are the weights of the head network.
All other parameters are ‘frozen’ because we set
<code>base_model.trainable=False</code>. Because only a small proportion
of the parameters have to be updated at each training step, this will
greatly speed up training time.</p>
</div>
<div class="section level3">
<h3 id="head-and-base-1">2. Head and base<a class="anchor" aria-label="anchor" href="#head-and-base-1"></a></h3>
<p>The head network starts at the <code>flatten</code> layer, 5 layers
before the final layer.</p>
</div>
<div class="section level3">
<h3 id="max-pooling-1">3. Max pooling<a class="anchor" aria-label="anchor" href="#max-pooling-1"></a></h3>
<p>The <code>max_pool</code> layer right before the <code>flatten</code>
layer is added because we provided <code>pooling='max'</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="compile-the-model" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="compile-the-model" class="callout-inner">
<h3 class="callout-title">1. Compile the model</h3>
<div class="callout-content">
<p>Compile the model: - Use the <code>adam</code> optimizer - Use the
<code>SparseCategoricalCrossentropy</code> loss with
<code>from_logits=True</code>. - Use ‘accuracy’ as a metric.</p>
<div class="section level3">
<h3 id="train-the-model">2. Train the model<a class="anchor" aria-label="anchor" href="#train-the-model"></a></h3>
<p>Train the model on the training dataset: - Use a batch size of 32 -
Train for 30 epochs, but use an earlystopper with a patience of 5 - Pass
the validation dataset as validation data so we can monitor performance
on the validation data during training - Store the result of training in
a variable called <code>history</code> - Training can take a while, it
is a much larger model than what we have seen so far.</p>
</div>
<div class="section level3">
<h3 id="inspect-the-results">3. Inspect the results<a class="anchor" aria-label="anchor" href="#inspect-the-results"></a></h3>
<p>Plot the training history and evaluate the trained model. What do you
think of the results?</p>
</div>
<div class="section level3">
<h3 id="optional-try-out-other-pre-trained-neural-networks">4. (Optional) Try out other pre-trained neural networks<a class="anchor" aria-label="anchor" href="#optional-try-out-other-pre-trained-neural-networks"></a></h3>
<p>Train and evaluate another pre-trained model from <a href="https://keras.io/api/applications/" class="external-link uri">https://keras.io/api/applications/</a>. How does it compare
to DenseNet121?</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="section level3">
<h3 id="compile-the-model-1">1. Compile the model<a class="anchor" aria-label="anchor" href="#compile-the-model-1"></a></h3>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>              loss<span class="op">=</span>keras.losses.SparseCategoricalCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>              metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="train-the-model-1">2. Train the model<a class="anchor" aria-label="anchor" href="#train-the-model-1"></a></h3>
<p>Define the early stopper:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>early_stopper <span class="op">=</span> keras.callbacks.EarlyStopping(monitor<span class="op">=</span><span class="st">'val_accuracy'</span>,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>                              patience<span class="op">=</span><span class="dv">5</span>)</span></code></pre>
</div>
<p>Train the model:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>history <span class="op">=</span> model.fit(x<span class="op">=</span>train_images,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                    y<span class="op">=</span>train_labels,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                    batch_size<span class="op">=</span><span class="dv">32</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                    epochs<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                    callbacks<span class="op">=</span>[early_stopper],</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                    validation_data<span class="op">=</span>(val_images, val_labels))</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="inspect-the-results-1">3. Inspect the results<a class="anchor" aria-label="anchor" href="#inspect-the-results-1"></a></h3>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="kw">def</span> plot_history(history, metrics):</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">    Plot the training history</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">        history (keras History object that is returned by model.fit())</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">        metrics(str, list): Metric or a list of metrics to plot</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    history_df <span class="op">=</span> pd.DataFrame.from_dict(history.history)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    sns.lineplot(data<span class="op">=</span>history_df[metrics])</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    plt.xlabel(<span class="st">"epochs"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>    plt.ylabel(<span class="st">"metric"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>plot_history(history, [<span class="st">'accuracy'</span>, <span class="st">'val_accuracy'</span>])</span></code></pre>
</div>
<p><img src="fig/05_training_history_transfer_learning.png" alt="Training history for training the pre-trained-model. The training accuracy slowly raises from 0.2 to 0.9 in 20 epochs. The validation accuracy starts higher at 0.25, but reaches a plateau around 0.64" class="figure">
The final validation accuracy reaches 64%, this is a huge improvement
over 30% accuracy we reached with the simple convolutional neural
network that we build from scratch in the previous episode.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="concluding-the-power-of-transfer-learning">Concluding: The power of transfer learning<a class="anchor" aria-label="anchor" href="#concluding-the-power-of-transfer-learning"></a></h2>
<hr class="half-width"><p>In many domains, large networks are available that have been trained
on vast amounts of data, such as in computer vision and natural language
processing. Using transfer learning, you can benefit from the knowledge
that was captured from another machine learning task. In many fields,
transfer learning will outperform models trained from scratch,
especially if your dataset is small or of poor quality.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Large pre-trained models capture generic knowledge about a
domain</li>
<li>Use the <code>keras.applications</code> module to easily use
pre-trained models for your own datasets</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="4-advanced-layer-types.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="6-outlook.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="4-advanced-layer-types.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Advanced layer types
        </a>
        <a class="chapter-link float-end" href="6-outlook.html" rel="next">
          Next: Outlook...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-lab/deep-learning-intro/edit/main/episodes/5-transfer-learning.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-lab/deep-learning-intro/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-lab/deep-learning-intro/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-lab/deep-learning-intro/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:deep-learning-lesson-dev@esciencecenter.nl">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://carpentries-lab.github.io/deep-learning-intro/5-transfer-learning.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "deep learning, keras, lesson, The Carpentries, neural networks",
  "name": "Transfer learning",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-lab.github.io/deep-learning-intro/5-transfer-learning.html",
  "identifier": "https://carpentries-lab.github.io/deep-learning-intro/5-transfer-learning.html",
  "dateCreated": "2020-10-17",
  "dateModified": "2025-02-11",
  "datePublished": "2025-05-13"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

